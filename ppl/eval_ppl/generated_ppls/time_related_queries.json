[
    {
        "question": "Show me the weekly average taxless total price summary in the last half year.",
        "target_index": "ecommerce",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce \n| where order_date > DATE_SUB(NOW(), INTERVAL 6 MONTH)\n| stats AVG(taxless_total_price) as weekly_avg_price \nby span(order_date, 1w)",
        "query": "source=ecommerce| where `order_date` > DATE_SUB(NOW(), INTERVAL 6 MONTH) | stats AVG(`taxless_total_price`) as avg_taxless_price by span(`order_date`, 1w)"
    },
    {
        "question": "Show the customer's full name and email address for customers who made purchases last week.",
        "target_index": "ecommerce",
        "type": "3",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where order_date > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| fields customer_full_name, email",
        "query": "source=ecommerce| where `order_date` >= DATE_SUB(NOW(), INTERVAL 1 WEEK) | fields `customer_full_name`, `email`"
    },
    {
        "question": "Get the customer full name, order date, and total quantity for orders placed by male customers in the last week.",
        "target_index": "ecommerce",
        "type": "3",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where customer_gender = \"MALE\" AND order_date > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| fields customer_full_name, order_date, total_quantity",
        "query": "source=ecommerce| where `customer_gender` = 'Male' and `order_date` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | fields `customer_full_name`, `order_date`, `total_quantity`"
    },
    {
        "question": "Can you show me the weekly average taxless total price summary in the last half year?",
        "target_index": "ecommerce",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce \n| where order_date > DATE_SUB(NOW(), INTERVAL 6 MONTH)\n| stats AVG(taxless_total_price) as weekly_avg_price \nby span(order_date, 1w)",
        "query": "source=ecommerce| where `order_date` > DATE_SUB(NOW(), INTERVAL 6 MONTH) | stats AVG(`taxless_total_price`) as avg_price by span(`order_date`, 1w)"
    },
    {
        "question": "How many unique customers had orders placed in the last week?",
        "target_index": "ecommerce",
        "type": "2",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where order_date > DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats DISTINCT_COUNT(customer_id) as unique_customers",
        "query": "source=ecommerce| where `order_date` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats DISTINCT_COUNT(`customer_id`) as unique_customers"
    },
    {
        "question": "List all products and their manufacturers for orders placed in the last week.",
        "target_index": "ecommerce",
        "type": "3",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where order_date > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| fields products.product_name, products.manufacturer",
        "query": "source=ecommerce| where `order_date` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | dedup `products.product_name`, `manufacturer` | fields `products.product_name`, `manufacturer`"
    },
    {
        "question": "Show me the weekly trend of the total number of orders in the last 3 months.",
        "target_index": "ecommerce",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where order_date > DATE_SUB(NOW(), INTERVAL 3 MONTH)\n| stats count() as total_orders by span(order_date, 1w)",
        "query": "source=ecommerce| where `order_date` > DATE_SUB(NOW(), INTERVAL 3 MONTH) | stats COUNT() as total_orders by span(`order_date`, 1w) | sort `order_date`"
    },
    {
        "question": "What is the ratio of orders made on Mondays in the last week?",
        "target_index": "ecommerce",
        "type": "8",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce \n| where order_date > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| eval is_monday=IF(LIKE(day_of_week, 'Monday'), 1.0, 0.0)\n| stats AVG(is_monday) as monday_ratio",
        "query": "source=ecommerce| where `order_date` >= DATE_SUB(NOW(), INTERVAL 1 WEEK) and DAYNAME(`order_date`) = 'Monday' | eval ratio = `total_quantity` / (SELECT COUNT() FROM ecommerce WHERE `order_date` = DATE_SUB(NOW(), INTERVAL 1 WEEK) AND DAYNAME(`order_date`) = 'Monday') | fields ratio"
    },
    {
        "question": "List all unique manufacturer with orders in the last 7 days.",
        "target_index": "ecommerce",
        "type": "4",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where order_date >= DATE_SUB(NOW(), INTERVAL 7 DAY)\n| dedup manufacturer\n| fields manufacturer",
        "query": "source=ecommerce| where `order_date` > DATE_SUB(NOW(), INTERVAL 7 DAY) | dedup `manufacturer` | fields `manufacturer`"
    },
    {
        "question": "Show me the weekly trend of the total number of orders.",
        "target_index": "ecommerce",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce | stats count() as total_orders by span(order_date, 1w)",
        "query": "source=ecommerce| eval week = WEEK_OF_YEAR(`order_date`) | stats count() as total_orders by week | sort week"
    },
    {
        "question": "List all unique customer first names with orders placed in the last week.",
        "target_index": "ecommerce",
        "type": "4",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where order_date > DATE_SUB(NOW(), INTERVAL 7 DAY)\n| dedup customer_first_name\n| fields customer_first_name",
        "query": "source=ecommerce| where `order_date` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | dedup `customer_first_name` | fields `customer_first_name`"
    },
    {
        "question": "List all unique customer first names with orders placed in the last 7 days.",
        "target_index": "ecommerce",
        "type": "4",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where order_date > DATE_SUB(NOW(), INTERVAL 7 DAY)\n| dedup customer_first_name\n| fields customer_first_name",
        "query": "source=ecommerce| where `order_date` > DATE_SUB(NOW(), INTERVAL 7 DAY) | dedup `customer_first_name` | fields `customer_first_name`"
    },
    {
        "question": "How many unique customers made orders in the last week?",
        "target_index": "ecommerce",
        "type": "2",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where order_date >= DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats DISTINCT_COUNT(customer_id) as unique_customers",
        "query": "source=ecommerce| where `order_date` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats DISTINCT_COUNT(`customer_id`) as unique_customers"
    },
    {
        "question": "List all customer first and last name, email, and order date for orders placed in the last week.",
        "target_index": "ecommerce",
        "type": "3",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where order_date > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| fields customer_first_name, customer_last_name, email, order_date",
        "query": "source=ecommerce| where `order_date` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | fields `customer_first_name`, `customer_last_name`, `email`, `order_date`"
    },
    {
        "question": "Find the average price of products purchased by customers from Egypt last week.",
        "target_index": "ecommerce",
        "type": "5",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "order_date",
        "origin_query": "source=ecommerce\n| where geoip.country_iso_code = \"EG\" \n| where order_date > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| stats avg(products.price) as avg_product_price",
        "query": "source=ecommerce| where `geoip.country_iso_code` = 'EG' AND `order_date` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats AVG(`products.price`) as avg_product_price"
    },
    {
        "question": "List all flights that departed from Frankfurt am Main Airport with a distance over 10,000 kilometers.",
        "target_index": "flight",
        "type": "3",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight\n| where Origin = \"Frankfurt am Main Airport\" AND DistanceKilometers > 10000\n| fields AvgTicketPrice, Cancelled, Carrier, Dest, DestAirportID, DestCityName, DestCountry, DestLocation, DestRegion, DestWeather, DistanceKilometers, DistanceMiles, FlightDelay, FlightDelayMin, FlightDelayType, FlightNum, FlightTimeHour, FlightTimeMin, Origin, OriginAirportID, OriginCityName, OriginCountry, OriginLocation, OriginRegion, OriginWeather, dayOfWeek, timestamp",
        "query": "source=flight| where `OriginAirportID` = 'FRA' and `DistanceKilometers` > 10000 | fields `FlightNum`, `OriginCityName`, `DestCityName`, `DistanceKilometers`"
    },
    {
        "question": "Show me the weekly trend of total flight count in the last month.",
        "target_index": "flight",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight\n| where timestamp > DATE_SUB(NOW(), INTERVAL 1 MONTH)\n| stats COUNT() as flight_count\nby span(timestamp, 1w)",
        "query": "source=flight| where `timestamp` >= DATE_SUB(NOW(), INTERVAL 1 MONTH) | eval week = WEEK_OF_YEAR(`timestamp`) | stats count() as total_flights by week | sort week"
    },
    {
        "question": "List the number of flights that departed from Frankfurt am Main Airport (FRA) last week.",
        "target_index": "flight",
        "type": "3",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight\n| where OriginAirportID = \"FRA\" \n| where timestamp >= DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| stats count() as total_flights",
        "query": "source=flight| where `OriginAirportID` = 'FRA' AND DATE(`timestamp`) >= DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats count() as flight_count"
    },
    {
        "question": "Find the ratio of flights that were canceled in the last 3 months.",
        "target_index": "flight",
        "type": "8",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight \n| where timestamp > DATE_SUB(NOW(), INTERVAL 3 MONTH)\n| eval is_cancelled=IF(Cancelled, 1.0, 0.0)\n| stats AVG(is_cancelled) as cancelled_ratio",
        "query": "source=flight| where `timestamp` >= DATE_SUB(NOW(), INTERVAL 3 MONTH) | eval is_canceled = if(`Cancelled`, 1, 0) | stats sum(is_canceled) as total_canceled, count() as total_flights | eval cancel_ratio = total_canceled / total_flights"
    },
    {
        "question": "What is the ratio of flights with destination weather being rain in the last 2 months?",
        "target_index": "flight",
        "type": "8",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight \n| where timestamp > DATE_SUB(NOW(), INTERVAL 2 MONTH)\n| eval is_rain = IF(LIKE(DestWeather, 'rain'), 1.0, 0.0)\n| stats AVG(is_rain) as rain_ratio",
        "query": "source=flight| where `timestamp` > DATE_SUB(NOW(), INTERVAL 2 MONTH) | eval is_rain = IF(`DestWeather` = 'Rain', 1, 0) | stats AVG(is_rain) as rain_ratio"
    },
    {
        "question": "Show me the monthly trend of the number of cancelled flights in the last year.",
        "target_index": "flight",
        "type": "7",
        "now": "TIMESTAMP('2026-07-27 12:34:56')",
        "date_field": "timestamp",
        "origin_query": "source=flight\n| where timestamp > DATE_SUB(NOW(), INTERVAL 1 YEAR)\n| where Cancelled=true | stats COUNT() as cancelled_flights by span(timestamp, 1M)\n",
        "query": "source=flight| where `timestamp` >= DATE_SUB(NOW(), INTERVAL 1 YEAR) and `Cancelled` = true | eval month = MONTH(`timestamp`) | stats count() as cancelled_flights by month | sort month"
    },
    {
        "question": "Find the ratio of flight delays in the last week.",
        "target_index": "flight",
        "type": "8",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight \n| where timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| eval is_delayed = IF(FlightDelay, 1.0, 0.0)\n| stats AVG(is_delayed) as delay_ratio",
        "query": "source=flight| where `timestamp` >= DATE_SUB(NOW(), INTERVAL 1 WEEK) | eval delay_ratio = if(`FlightDelay`, 1, 0) | stats avg(delay_ratio) as avg_delay_ratio"
    },
    {
        "question": "Show me the daily trend of the total flight distance in the last month.",
        "target_index": "flight",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight\n| where timestamp > DATE_SUB(NOW(), INTERVAL 1 MONTH)\n| eval total_distance = DistanceKilometers\n| stats sum(total_distance) as daily_total_distance by span(timestamp, 1d)",
        "query": "source=flight| where `timestamp` >= DATE_SUB(NOW(), INTERVAL 1 MONTH) | stats sum(`DistanceKilometers`) as total_distance by span(`timestamp`, 1d) | sort `timestamp`"
    },
    {
        "question": "List all flights that departed from Frankfurt am Main Airport on a sunny day.",
        "target_index": "flight",
        "type": "3",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight\n| where OriginCityName = \"Frankfurt am Main\" AND OriginWeather = \"Sunny\"\n| fields Carrier, Dest, DestCityName, DistanceKilometers, FlightNum, Origin, OriginCityName, OriginWeather, timestamp",
        "query": "source=flight| where `OriginAirportID` = 'FRA' AND `OriginWeather` = 'Sunny' | fields `FlightNum`, `OriginCityName`, `DestCityName`, `FlightDelay`"
    },
    {
        "question": "How many unique destination airports for flights last week?",
        "target_index": "flight",
        "type": "2",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight\n| where timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| stats DISTINCT_COUNT(DestAirportID) as unique_dest_airports",
        "query": "source=flight| where `timestamp` >= DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats dc(`DestAirportID`) as unique_dest_airports"
    },
    {
        "question": "Show me the weekly trend of the average DistanceKilometers in the last 3 months.",
        "target_index": "flight",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight | where timestamp > DATE_SUB(NOW(), INTERVAL 3 MONTH) | stats AVG(DistanceKilometers) as weekly_avg_distance by span(timestamp, 1w)",
        "query": "source=flight| where `timestamp` >= DATE_SUB(NOW(), INTERVAL 3 MONTH) | eval week = WEEK_OF_YEAR(`timestamp`) | stats avg(`DistanceKilometers`) as avg_distance by week | sort week"
    },
    {
        "question": "Find the ratio of flights where the origin country is Germany in the last 3 months.",
        "target_index": "flight",
        "type": "8",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=flight \n| where timestamp > DATE_SUB(NOW(), INTERVAL 3 MONTH)\n| eval is_origin_de = IF(LIKE(OriginCountry, 'DE'), 1.0, 0.0)\n| stats AVG(is_origin_de) as origin_de_ratio",
        "query": "source=flight| where `timestamp` > DATE_SUB(NOW(), INTERVAL 3 MONTH) AND `OriginCountry` = 'Germany' | eval is_german = 1 | where is_german = 1 | stats COUNT() as total_count | stats COUNT() as german_count | eval ratio = german_count / total_count"
    },
    {
        "question": "Show me the monthly trend of the number of documents in the last 6 months.",
        "target_index": "log_index",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index | where timestamp > DATE_SUB(NOW(), INTERVAL 6 MONTH) | stats count() as document_count by span(timestamp, 1M)",
        "query": "source=log_index| where `timestamp` > DATE_SUB(NOW(), INTERVAL 6 MONTH) | stats COUNT() as count by span(`timestamp`, 1m)"
    },
    {
        "question": "What is the ratio of log entries where the request extension is 'deb' in the last month?",
        "target_index": "log_index",
        "type": "8",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index \n| where timestamp > DATE_SUB(NOW(), INTERVAL 1 MONTH)\n| eval is_deb = IF(LIKE(extension, 'deb'), 1.0, 0.0)\n| stats AVG(is_deb) as deb_ratio",
        "query": "source=log_index| where `timestamp` > DATE_SUB(NOW(), INTERVAL 1 MONTH) | eval is_deb = IF(LIKE(`extension`, '%deb%'), 1, 0) | stats AVG(is_deb) as deb_ratio"
    },
    {
        "question": "Show me the monthly trend of total bytes transferred for the logs from the last 3 months.",
        "target_index": "log_index",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index \n| where timestamp > DATE_SUB(NOW(), INTERVAL 3 MONTH)\n| stats sum(bytes) as total_bytes by span(timestamp, 1M)",
        "query": "source=log_index| where `timestamp` > DATE_SUB(NOW(), INTERVAL 3 MONTH) | stats SUM(`bytes`) as total_bytes by span(`timestamp`, 1m)"
    },
    {
        "question": "How many unique agents accessed the website in the last 7 days?",
        "target_index": "log_index",
        "type": "2",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "utc_time",
        "origin_query": "source=log_index\n| where utc_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats DISTINCT_COUNT(agent) as unique_agents",
        "query": "source=log_index| where `timestamp` > DATE_SUB(NOW(), INTERVAL 7 DAY) | stats DISTINCT_COUNT(`agent`) as unique_agents"
    },
    {
        "question": "Count the number of logs with a request that contains \"opensearch\" in the last 5 minutes.",
        "target_index": "log_index",
        "type": "1",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index \n| where QUERY_STRING(['request'], '%opensearch%') \n| where timestamp > DATE_SUB(NOW(), INTERVAL 5 MINUTE)\n| stats COUNT() as opensearch_requests",
        "query": "source=log_index| where query_string(['request'], 'opensearch') AND `timestamp` > DATE_SUB(CURTIME(), INTERVAL 5 MINUTE) | stats COUNT() as count"
    },
    {
        "question": "Calculate the ratio of documents with a machine.os of \"win 8\" in the last 30 days.",
        "target_index": "log_index",
        "type": "8",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index | where timestamp > DATE_SUB(NOW(), INTERVAL 30 DAY) | eval is_win8 = IF(LIKE(machine.os, 'win 8'), 1.0, 0.0) | stats AVG(is_win8) as win8_ratio",
        "query": "source=log_index| where `timestamp` > DATE_SUB(NOW(), INTERVAL 30 DAY) AND `machine.os` = \"win 8\" | stats COUNT() as count_win8 | eval ratio = count_win8 / (SELECT COUNT() FROM log_index)"
    },
    {
        "question": "Show me the daily trend of total 404 errors in the last week.",
        "target_index": "log_index",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index \n| where timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) \n| where QUERY_STRING(['response'], '404')\n| stats count() as total_404_errors\nby span(timestamp, 1d)",
        "query": "source=log_index| where `response` = '404' AND `timestamp` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats COUNT() as count by span(`timestamp`, 1d)"
    },
    {
        "question": "List all messages and timestamps for log entries with response code not equal to 200.",
        "target_index": "log_index",
        "type": "3",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index\n| where response != \"200\"\n| fields message, timestamp",
        "query": "source=log_index| where `response` != '200' | fields `message`, `timestamp`"
    },
    {
        "question": "List all URLs along with the HTTP response codes for requests made in the last 24 hours.",
        "target_index": "log_index",
        "type": "3",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index\n| where timestamp > DATE_SUB(NOW(), INTERVAL 1 DAY)\n| fields url, response",
        "query": "source=log_index| where `timestamp` > DATE_SUB(NOW(), INTERVAL 24 HOUR) | fields `url`, `response`"
    },
    {
        "question": "What is the ratio of 5xx response codes in the last week?",
        "target_index": "log_index",
        "type": "8",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index \n| where timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| eval is_5xx = IF(LIKE(response, '5%'), 1.0, 0.0)\n| stats AVG(is_5xx) as five_xx_ratio",
        "query": "source=log_index| where `timestamp` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | eval is_5xx = IF(LIKE(cast(`response` as string), '5%'), 1.0, 0.0) | stats AVG(is_5xx) as pct_5xx_ratio"
    },
    {
        "question": "List all unique user agents with visits from India in the last 7 days.",
        "target_index": "log_index",
        "type": "4",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index\n| where geo.src = \"IN\"\n| where timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY)\n| dedup agent\n| fields agent",
        "query": "source=log_index| where `geo.src` = 'IN' AND `timestamp` > DATE_SUB(NOW(), INTERVAL 7 DAY) | dedup `agent` | fields `agent`"
    },
    {
        "question": "Show me the daily trend of website traffic in the last week.",
        "target_index": "log_index",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index \n| where timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats count() as daily_traffic by span(timestamp, 1d)",
        "query": "source=log_index| where `timestamp` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats COUNT() as daily_visitors by span(`timestamp`, 1d)"
    },
    {
        "question": "List the URL and request fields for all documents with a client IP from India in the last 7 days.",
        "target_index": "log_index",
        "type": "3",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index\n| where geo.src=\"IN\" and timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY)\n| fields url, request",
        "query": "source=log_index| where `geo.src` = 'IN' AND `timestamp` > DATE_SUB(NOW(), INTERVAL 7 DAY) | fields `url`, `request`"
    },
    {
        "question": "How many 4xx and 5xx errors do I have in the last week?",
        "target_index": "log_index",
        "type": "1",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "timestamp",
        "origin_query": "source=log_index \n| where timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) \n| where QUERY_STRING(['response'], '4* OR 5*')\n| stats count() as error_cnt",
        "query": "source=log_index| where QUERY_STRING(['response'], '4* OR 5*') AND `timestamp` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats COUNT() as count"
    },
    {
        "question": "List all unique user agents with logs from last week.",
        "target_index": "log_index",
        "type": "4",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "utc_time",
        "origin_query": "source=log_index\n| where utc_time >= DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| dedup agent\n| fields agent",
        "query": "source=log_index| where `timestamp` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | dedup `agent` | fields `agent`"
    },
    {
        "question": "List all unique client IP addresses for logs with response code 404 in the last week.",
        "target_index": "log_index",
        "type": "4",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "utc_time",
        "origin_query": "source=log_index\n| where response = \"404\" AND utc_time > DATE_SUB(NOW(), INTERVAL 7 DAY)  \n| dedup clientip\n| fields clientip",
        "query": "source=log_index| where `response` = '404' AND `timestamp` > DATE_SUB(NOW(), INTERVAL 1 WEEK) | dedup `clientip` | fields `clientip`"
    },
    {
        "question": "Find the average duration of HTTP GET requests for the '/jquery-3.1.1.min.js' URL over the last 24 hours.",
        "target_index": "otel_logs",
        "type": "5",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where `span.attributes.http@url` = \"/jquery-3.1.1.min.js\" AND `span.attributes.http@method` = \"GET\" AND endTime >= DATE_SUB(NOW(), INTERVAL 1 DAY)\n| stats avg(durationInNanos) as avg_duration",
        "query": "source=otel_logs| where `startTime` > DATE_SUB(NOW(), INTERVAL 24 HOUR) AND `span.attributes.http@request_content_length` = '/jquery-3.1.1.min.js' AND `span.attributes.http@method` = 'GET' | stats AVG(`span.attributes.total_time_microseconds`) as avg_duration"
    },
    {
        "question": "Find the number of unique HTTP status codes for requests received yesterday.",
        "target_index": "otel_logs",
        "type": "2",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where DATE(endTime) = DATE_SUB(NOW(), INTERVAL 1 DAY)\n| stats DISTINCT_COUNT(`span.attributes.http@status_code`) as unique_status_codes",
        "query": "source=otel_logs| where DATE(`startTime`) = DATE_SUB(CURDATE(), INTERVAL 1 DAY) | stats dc(`span.attributes.http@status_code`) as unique_status_codes"
    },
    {
        "question": "What is the ratio of logs with status code not equal to 200 in the last 24 hours?",
        "target_index": "otel_logs",
        "type": "8",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where endTime > DATE_SUB(NOW(), INTERVAL 1 DAY)\n| eval is_error=IF(LIKE(`span.attributes.http@status_code`, '200'), 0, 1) \n| stats AVG(is_error) as error_ratio",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 24 HOUR) | eval is_not_200 = `status.code` != '200' | stats COUNT() as total_logs, COUNT(is_not_200) as not_200_logs | eval ratio = not_200_logs / total_logs"
    },
    {
        "question": "How many logs from the frontend service for the HTTP GET method have a status code of 200 in the last 24 hours?",
        "target_index": "otel_logs",
        "type": "1",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "startTime",
        "origin_query": "source=otel_logs\n| where `resource.attributes.service@name` = \"frontend\" \n  AND `span.attributes.http@method` = \"GET\"\n  AND `span.attributes.http@status_code` = \"200\"\n  AND startTime > DATE_SUB(NOW(), INTERVAL 1 DAY)\n| stats COUNT() as log_count",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 24 HOUR) and `serviceName` = 'frontend' and `span.attributes.http@method` = 'GET' and `span.attributes.http@status_code` = '200' | stats count() as log_count"
    },
    {
        "question": "List all unique HTTP status codes for requests made in the last 24 hours.",
        "target_index": "otel_logs",
        "type": "4",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where endTime > DATE_SUB(NOW(), INTERVAL 1 DAY)\n| dedup `span.attributes.http@status_code`\n| fields `span.attributes.http@status_code`",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 24 HOUR) | dedup `span.attributes.http@status_code` | sort `span.attributes.http@status_code`"
    },
    {
        "question": "Get the average duration of server-side HTTP requests for the frontend service in the last 24 hours.",
        "target_index": "otel_logs",
        "type": "5",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where `resource.attributes.service@name` = \"frontend\" AND kind = \"SPAN_KIND_SERVER\"\n| where endTime > DATE_SUB(NOW(), INTERVAL 1 DAY) \n| stats avg(durationInNanos) as avg_duration_nanos",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 24 HOUR) and `serviceName` = 'frontend' and `span.attributes.http@scheme` = 'http' | stats avg(`span.attributes.http@response_content_length`) as avg_duration by `span.attributes.http@request_content_length`"
    },
    {
        "question": "List all trace IDs for successful HTTP requests in the last 24 hours.",
        "target_index": "otel_logs",
        "type": "3",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where `span.attributes.http@status_code` = \"200\" AND endTime > DATE_SUB(NOW(), INTERVAL 1 DAY)\n| fields traceId",
        "query": "source=otel_logs| where `startTime` > DATE_SUB(NOW(), INTERVAL 24 HOUR) and `span.attributes.http@status_code` = '200' | fields `traceId` | dedup `traceId`"
    },
    {
        "question": "Display the number of unique HTTP status codes for requests made in the last 24 hours.",
        "target_index": "otel_logs",
        "type": "2",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "startTime",
        "origin_query": "source=otel_logs\n| where startTime > DATE_SUB(NOW(), INTERVAL 1 DAY) \n| stats DISTINCT_COUNT(`span.attributes.http@status_code`) as unique_status_codes",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 24 HOUR) | stats dc(`span.attributes.http@status_code`) as unique_status_codes"
    },
    {
        "question": "Show me the weekly trend of document counts for logs with an HTTP GET status code of 200 in the last month.",
        "target_index": "otel_logs",
        "type": "7",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs \n| where `span.attributes.http@status_code` = \"200\" AND `span.attributes.http@method` = \"GET\" AND endTime > DATE_SUB(NOW(), INTERVAL 1 MONTH)\n| stats count() as log_count by span(endTime, 1w)",
        "query": "source=otel_logs| where `startTime` > DATE_SUB(NOW(), INTERVAL 1 MONTH) and `span.attributes.http@method` = 'GET' and `span.attributes.http@status_code` = '200' | eval week = WEEK_OF_YEAR(`startTime`) | stats count() as document_count by week | sort week"
    },
    {
        "question": "Show me the monthly average duration of traces for the last 6 months.",
        "target_index": "otel_logs",
        "type": "7",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs \n| where endTime > DATE_SUB(NOW(), INTERVAL 6 MONTH)\n| stats AVG(durationInNanos) as avg_duration by span(endTime, 1M)",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 6 MONTH) | eval month = DATE_FORMAT(`startTime`, 'yyyy-MM') | stats AVG(`durationInNanos`) as avg_duration by month | sort month"
    },
    {
        "question": "What is the ratio of logs that have an HTTP status code of 500 in the last 7 days?",
        "target_index": "otel_logs",
        "type": "8",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where endTime > DATE_SUB(NOW(), INTERVAL 7 DAY)\n| eval is_500=IF(LIKE('`span.attributes.http@status_code`', '500'), 1.0, 0.0)\n| stats AVG(is_500) as ratio_500",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 7 DAY) | eval is_error = IF(`span.attributes.http@status_code` = '500', 1, 0) | stats AVG(is_error) as error_ratio"
    },
    {
        "question": "How many distinct HTTP status codes were seen in the last week's logs?",
        "target_index": "otel_logs",
        "type": "2",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where endTime > DATE_SUB(NOW(), INTERVAL 1 WEEK)  \n| stats DISTINCT_COUNT(`span.attributes.http@status_code`) as unique_status_codes",
        "query": "source=otel_logs| where `startTime` > DATE_SUB(NOW(), INTERVAL 7 DAY) | stats DISTINCT_COUNT(`span.attributes.http@status_code`) as distinct_status_codes"
    },
    {
        "question": "Find the maximum duration of server-side HTTP requests received by the frontend service in the last 24 hours.",
        "target_index": "otel_logs",
        "type": "5",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where `resource.attributes.service@name` = \"frontend\" AND kind = \"SPAN_KIND_SERVER\"\n| where endTime >= DATE_SUB(NOW(), INTERVAL 1 DAY)\n| stats max(durationInNanos) as max_duration",
        "query": "source=otel_logs| where `startTime` > DATE_SUB(NOW(), INTERVAL 24 HOUR) | eval duration = DATEDIFF(`startTime`, `startTime`) | stats MAX(duration) as max_duration_seconds by `resource.attributes.service@name`"
    },
    {
        "question": "List all the URLs accessed by the frontend service in the last 5 minutes.",
        "target_index": "otel_logs",
        "type": "3",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where `resource.attributes.service@name` = \"frontend\" AND endTime > DATE_SUB(NOW(), INTERVAL 5 MINUTE)\n| fields `span.attributes.http@url`",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 5 MINUTE) and `serviceName` = 'frontend' | dedup `span.attributes.http@url` | fields `span.attributes.http@url`"
    },
    {
        "question": "Show me the weekly trend of the number of logs in the last month.",
        "target_index": "otel_logs",
        "type": "7",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where endTime > DATE_SUB(NOW(), INTERVAL 1 MONTH)\n| stats count() as log_count by span(endTime, 1w)",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 1 MONTH) | eval week = WEEK_OF_YEAR(`startTime`) | stats count() as log_count by week | sort week"
    },
    {
        "question": "How many http requests have a status code other than 200 in the last 5 minutes?",
        "target_index": "otel_logs",
        "type": "1",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where endTime > DATE_SUB(NOW(), INTERVAL 5 MINUTE)\n| where NOT QUERY_STRING(['`span.attributes.http@status_code`'], '200')\n| stats count() as error_request_count",
        "query": "source=otel_logs| where `startTime` > DATE_SUB(NOW(), INTERVAL 5 MINUTE) and `span.attributes.http@status_code` != '200' | stats COUNT() as non_200_count"
    },
    {
        "question": "What is the ratio of logs related to the HTTP GET method in the last 5 minutes?",
        "target_index": "otel_logs",
        "type": "8",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "startTime",
        "origin_query": "source=otel_logs\n| where startTime > DATE_SUB(NOW(), INTERVAL 5 MINUTE)\n| eval is_get_method = IF(LIKE(`span.attributes.http@method`, 'GET'), 1.0, 0.0)\n| stats AVG(is_get_method) as ratio_get_method",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 5 MINUTE) | eval is_get_method = IF(`span.attributes.http@method` = 'GET', 1, 0) | stats SUM(is_get_method) as get_count, COUNT() as total_count | eval ratio = get_count / total_count"
    },
    {
        "question": "Show me the top 5 URLs requested by the frontend service in the last 3 days, ordered by the number of requests.",
        "target_index": "otel_logs",
        "type": "6",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where `resource.attributes.service@name` = \"frontend\" AND endTime > DATE_SUB(NOW(), INTERVAL 3 DAY)\n| stats COUNT() AS request_count BY `span.attributes.http@url`\n| sort -request_count\n| head 5\n| fields `span.attributes.http@url`, request_count",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 3 DAY) and `serviceName` = 'frontend' | stats count() as request_count by `span.attributes.http@url` | sort -request_count | head 5"
    },
    {
        "question": "List all unique response codes for requests made in the last 1 hour.",
        "target_index": "otel_logs",
        "type": "4",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "startTime",
        "origin_query": "source=otel_logs\n| where startTime > DATE_SUB(NOW(), INTERVAL 1 HOUR)\n| dedup `span.attributes.http@status_code`\n| fields `span.attributes.http@status_code`",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 1 HOUR) | dedup `span.attributes.http@status_code` | fields `span.attributes.http@status_code`"
    },
    {
        "question": "Show me the top 5 most accessed URLs with HTTP status code 200 in the last 24 hours.",
        "target_index": "otel_logs",
        "type": "6",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where `span.attributes.http@status_code` = \"200\" AND endTime > DATE_SUB(NOW(), INTERVAL 1 DAY)\n| stats COUNT() AS count BY `span.attributes.http@url`\n| sort -count\n| head 5\n| fields `span.attributes.http@url`, count",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 24 HOUR) and `span.attributes.http@status_code` = '200' | stats count() as access_count by `span.attributes.http@url` | sort -access_count | head 5"
    },
    {
        "question": "List all unique HTTP status codes for requests made in the last hour.",
        "target_index": "otel_logs",
        "type": "4",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "startTime",
        "origin_query": "source=otel_logs\n| where startTime > DATE_SUB(NOW(), INTERVAL 1 HOUR)\n| dedup `span.attributes.http@status_code`\n| fields `span.attributes.http@status_code`",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 1 HOUR) | dedup `span.attributes.http@status_code` | sort `span.attributes.http@status_code`"
    },
    {
        "question": "Find the ratio of logs in the last 24 hours that have an HTTP status code not equal to 200.",
        "target_index": "otel_logs",
        "type": "8",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where endTime > DATE_SUB(NOW(), INTERVAL 1 DAY)\n| eval is_not_200 = IF(LIKE(`span.attributes.http@status_code`, '200'), 0.0, 1.0)\n| stats AVG(is_not_200) as ratio_not_200",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 24 HOUR) | eval non_200_status = IF(`span.attributes.http@status_code` != '200', 1, 0) | stats SUM(non_200_status) as non_200_count, COUNT() as total_count | eval ratio = non_200_count / total_count"
    },
    {
        "question": "List all the status codes and their corresponding count for the HTTP requests received in the last hour.",
        "target_index": "otel_logs",
        "type": "3",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "startTime",
        "origin_query": "source=otel_logs\n| where startTime > DATE_SUB(NOW(), INTERVAL 1 HOUR)\n| stats COUNT() AS count by `span.attributes.http@status_code`\n| fields `span.attributes.http@status_code`, count",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 1 HOUR) | stats count() as request_count by `span.attributes.http@status_code` | sort -request_count"
    },
    {
        "question": "Show me the top 5 services that had the most failed requests (status code not 200) in the last hour.",
        "target_index": "otel_logs",
        "type": "6",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "startTime",
        "origin_query": "source=otel_logs\n| where startTime > DATE_SUB(NOW(), INTERVAL 1 HOUR)\n| where `span.attributes.http@status_code` != '200'\n| stats count() as failed_requests by `resource.attributes.service@name`\n| sort -failed_requests\n| head 5\n| fields `resource.attributes.service@name`, failed_requests",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 1 HOUR) and `span.attributes.http@status_code` != '200' | stats count() as failed_requests by `serviceName` | sort -failed_requests | head 5"
    },
    {
        "question": "Show me the weekly trend of the number of logs with error status code (non-200) in the last month.",
        "target_index": "otel_logs",
        "type": "7",
        "now": "TIMESTAMP('2025-10-23 07:43:30')",
        "date_field": "endTime",
        "origin_query": "source=otel_logs\n| where endTime > DATE_SUB(NOW(), INTERVAL 1 MONTH) AND `span.attributes.http@status_code` != \"200\"\n| stats COUNT() as error_logs by SPAN(endTime, 1w)",
        "query": "source=otel_logs| where `startTime` >= DATE_SUB(NOW(), INTERVAL 1 MONTH) | where `status.code` != '200' | eval week = WEEK_OF_YEAR(`startTime`) | stats count() as error_count by week | sort week"
    },
    {
        "question": "Find the ratio of logs where the request URL contains the word \"recommendations\" in the last week.",
        "target_index": "sso_log",
        "type": "8",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log \n| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| eval is_recommendations = IF(LIKE(http.url, '%recommendations%'), 1.0, 0.0)\n| stats AVG(is_recommendations) as recommendations_ratio",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) | eval contains_recommendations = IF(LIKE(`http.url`, '%recommendations%'), 1, 0) | stats AVG(contains_recommendations) as ratio_recommendations"
    },
    {
        "question": "How many logs have a 4xx or 5xx HTTP status code in the last week?",
        "target_index": "sso_log",
        "type": "1",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where QUERY_STRING(['http.response.status_code'], '4* OR 5*')  \n| where @timestamp >= DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats COUNT() as error_logs_count",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) AND QUERY_STRING(['http.response.status_code'], '4* OR 5*') | stats COUNT() as count"
    },
    {
        "question": "Show me the daily trend of HTTP response status codes in the last week.",
        "target_index": "sso_log",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| stats count() as count \n  by span(@timestamp, 1d), http.response.status_code",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats COUNT() as count by span(@timestamp, 1d), `http.response.status_code` | sort @timestamp"
    },
    {
        "question": "How many unique source IP addresses were accessed in the last 7 days?",
        "target_index": "sso_log",
        "type": "2",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where @timestamp >= DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats DISTINCT_COUNT(communication.source.ip) as unique_source_ips",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY) | stats DISTINCT_COUNT(`communication.source.ip`) as unique_ips"
    },
    {
        "question": "List all unique HTTP response status codes in logs from the last 7 days.",
        "target_index": "sso_log",
        "type": "4",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY)\n| dedup http.response.status_code\n| fields http.response.status_code",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY) | dedup `http.response.status_code` | sort `http.response.status_code`"
    },
    {
        "question": "Calculate the ratio of logs where the URL contains \"api\" in the last week.",
        "target_index": "sso_log",
        "type": "8",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log | where @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) | eval has_api=IF(LIKE(http.url, '%api%'), 1.0, 0.0) | stats AVG(has_api) as ratio_with_api",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) | eval api_present = IF(LIKE(`http.url`, '%api%'), 1, 0) | stats AVG(api_present) as api_ratio"
    },
    {
        "question": "Calculate the average HTTP response bytes for successful requests with requests from production environment in the last 7 days.",
        "target_index": "sso_log",
        "type": "5",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where attributes.data_stream.namespace = \"production\" \n    AND event.result = \"success\"\n    AND @timestamp >= DATE_SUB(NOW(), INTERVAL 7 DAY) \n| stats avg(http.response.bytes) as avg_response_bytes",
        "query": "source=sso_log| where `event.result` = 'success' AND `attributes.data_stream.namespace` = 'production' AND @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY) | stats AVG(`http.response.bytes`) as avg_response_bytes"
    },
    {
        "question": "Show me the weekly trend of HTTP response status codes in the last month.",
        "target_index": "sso_log",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 MONTH)\n| stats count() as total_count by span(@timestamp, 1w), http.response.status_code\n| sort - total_count",
        "query": "source=sso_log| where @timestamp >= DATE_SUB(NOW(), INTERVAL 1 MONTH) | eval week = WEEK_OF_YEAR(@timestamp) | stats count() by week, `http.response.status_code` | sort week"
    },
    {
        "question": "How many unique events occurred in the frontend service last week?",
        "target_index": "sso_log",
        "type": "2",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where @timestamp >= DATE_SUB(NOW(), INTERVAL 7 DAY) AND @timestamp < NOW()\n| stats DISTINCT_COUNT(event.name) as unique_events",
        "query": "source=sso_log| where `attributes.data_stream.dataset` = 'frontend' AND @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats DISTINCT_COUNT(`event.name`) as unique_events"
    },
    {
        "question": "Show me the weekly trend of unique users accessing the application in the last month.",
        "target_index": "sso_log",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log | where @timestamp > DATE_SUB(NOW(), INTERVAL 1 MONTH) | stats DISTINCT_COUNT(communication.source.ip) as unique_users by span(@timestamp, 1w)",
        "query": "source=sso_log| where @timestamp >= DATE_SUB(NOW(), INTERVAL 1 MONTH) | eval week = WEEK_OF_YEAR(@timestamp) | stats dc(`communication.source.ip`) as unique_users by week | sort week"
    },
    {
        "question": "Find the average HTTP response bytes for successful requests (HTTP response status code 200) in the last 24 hours.",
        "target_index": "sso_log",
        "type": "5",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where http.response.status_code = \"200\"\n| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 DAY)\n| stats AVG(http.response.bytes) as avg_bytes",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 24 HOUR) AND `http.response.status_code` = '200' | stats AVG(`http.response.bytes`) as avg_response_bytes"
    },
    {
        "question": "Show me the top 5 events with error status code in the last 7 days.",
        "target_index": "sso_log",
        "type": "6",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where http.response.status_code != \"200\"\n| where @timestamp >= DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats count() as total by event.name\n| sort - total\n| head 5\n| fields event.name, total",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY) AND `event.result` = 'error' | sort - `event.name` | head 5"
    },
    {
        "question": "How many error logs do I have from the last week?",
        "target_index": "sso_log",
        "type": "1",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log \n| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) \n| where QUERY_STRING(['http.response.status_code'], '4* OR 5*')\n| stats count() as error_logs",
        "query": "source=sso_log| where `event.result` = 'error' AND @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats COUNT()"
    },
    {
        "question": "Generate a weekly trend of successful login events in the sso_log index.",
        "target_index": "sso_log",
        "type": "7",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log \n| where event.result = \"success\" \n| stats count() as successful_logins \nby span(@timestamp, 1w)",
        "query": "source=sso_log| where `event.name` = 'login_success' | stats COUNT() as count by span(@timestamp, 1w)"
    },
    {
        "question": "Find the average HTTP response bytes for successful web access events in the last 7 days.",
        "target_index": "sso_log",
        "type": "5",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where event.result = \"success\" AND event.category = \"web\" AND @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats avg(http.response.bytes) as avg_response_bytes",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY) AND `event.category` = 'web_access' AND `event.result` = 'success' | stats AVG(`http.response.bytes`) as avg_response_bytes"
    },
    {
        "question": "Find the average HTTP response size for successful requests in the last 7 days.",
        "target_index": "sso_log",
        "type": "5",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where http.response.status_code = \"200\" \n| where @timestamp >= DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats AVG(http.response.bytes) as avg_response_size",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY) AND `event.result` = 'success' | stats AVG(`http.response.bytes`) as avg_response_size"
    },
    {
        "question": "How many unique event types were recorded for frontend.access logs in the production namespace last week?",
        "target_index": "sso_log",
        "type": "2",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where attributes.data_stream.namespace = \"production\" \n  AND attributes.data_stream.dataset = \"frontend.access\"\n  AND @timestamp >= DATE_SUB(NOW(), INTERVAL 1 WEEK)\n| stats DISTINCT_COUNT(event.type) as unique_event_types",
        "query": "source=sso_log| where `attributes.data_stream.namespace` = 'production' AND `event.domain` = 'frontend' AND @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats DISTINCT_COUNT(`event.type`) as unique_event_types"
    },
    {
        "question": "Show me the top 10 most accessed URLs in the last 7 days.",
        "target_index": "sso_log",
        "type": "6",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats count() as total by http.url\n| sort - total\n| head 10\n| fields http.url, total",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY) | stats COUNT() as count by `http.url` | sort -count | head 10"
    },
    {
        "question": "How many logs have error status code in the last week?",
        "target_index": "sso_log",
        "type": "1",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log\n| where @timestamp > DATE_SUB(NOW(), INTERVAL 7 DAY) \n| where QUERY_STRING(['http.response.status_code'], '4* OR 5*')\n| stats COUNT() as error_logs_7days",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) AND `http.response.status_code` >= '400' | stats COUNT() as error_count"
    },
    {
        "question": "How many unique communication source IP addresses were recorded in the logs last week?",
        "target_index": "sso_log",
        "type": "2",
        "now": "TIMESTAMP('2025-05-27 03:53:30')",
        "date_field": "@timestamp",
        "origin_query": "source=sso_log \n| where @timestamp >= DATE_SUB(NOW(), INTERVAL 7 DAY)\n| stats DISTINCT_COUNT(communication.source.ip) as unique_source_ips",
        "query": "source=sso_log| where @timestamp > DATE_SUB(NOW(), INTERVAL 1 WEEK) | stats DISTINCT_COUNT(`communication.source.ip`) as unique_ips"
    }
]